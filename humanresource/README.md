# Схема `humanresource`

## Таблицы

1. `clients`      - таблица клиентов
2. `clients_card` - таблица скидочных карт клиентов
3. `employees`    - таблица сотрудников

## Функции

### Добавление и обновление пользователя
```sql
SELECT humanresource.clients_upd(_src := '
                                 {
                                   "client_id": 3,
                                   "phone": "89997776544",
                                   "name": "Пётр ",
                                   "birth_date": "1999-02-03"
                                 }'::jsonb
                                 , _ch_employee_id := 2542);
```
При вводе существующего `client_id` запись о клиенте обновится.  
При `client_id` NULL добавится новый клиент, и для него будет создана новая скидочная карта первого уровня.

Пример ответа при правильном выполнении:
```jsonb
{"data" : null}
```


### Добавление и обновление сотрудника
```sql
SELECT humanresource.employees_upd('{
                                      "employee_id": 10,
                                      "phone": "89441163660",
                                      "name": "Рунова Мия Федоровна",
                                      "birth_date": "1978-04-27",
                                      "rank_id": 1,
                                      "is_deleted": true
                                    }
                                   ', 2542)
```
При вводе существующего `employee_id` запись о сотруднике обновится.  
При `employee_id` NULL добавится новый сотрудник.  
`"is_deleted"` всегда должен быть заполнен: уволенный сотрудник - `true`, не уволенный - `false`.

Пример ответа при правильном выполнении:
```jsonb
{"data" : null}
```